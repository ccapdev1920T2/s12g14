<main>
  <div class="container">
    <div class="row justify-content-between">
      <div class="col col-sm-7 bg-cstm-green-lightest p-4">
        <h1><strong>{{recipe.name}}</strong></h1>
        <div id="profile-area">
          <a href="/profile/{{author.username}}" class="no-hover">
            <img id="profile-img" class="rounded-circle" src="{{author.picture_link}}">
            <span id="profile-name" class="ml-1 text-dark">{{author.display_name}}</span>
          </a>
        </div>
        <div id="recipe-area" class="h-50 mt-4">
          <h2 id="servings"><em>Servings:</em></h2>
          <h4 id="servings-number"><em>{{recipe.servings}}</em></h4>
        </div>
        <div id="recipe-interactions" class="my-3">
          <h5 class="float-left">{{like_count}} like(s)</h5>
          {{#if registered}}
            {{#if liked}}
            <span id="registered-liked"><a href="/recipe/{{recipeId}}/unlike" class="text-dark">Unlike this recipe</a></span>
            {{else}}
            <span id="registered-like"><a href="/recipe/{{recipeId}}/like" class="text-dark">Like this recipe!</a></span>
            {{/if}}
            {{#if owned}}
            <form action="/recipe/{{recipeId}}/delete" method="POST">
              <button type="submit">Delete</button>
            </form>
            {{/if}}
          {{else}}
          <span class="float-right" id="unregistered-like">Register to like recipes!</span>
          {{/if}}
        </div>
      </div>
      <div class="col col-sm-4 bg-cstm-orange">
        <img src="{{recipe.picture_link}}" class="rounded img-fluid">
      </div>
    </div>
    {{#if recipe.description}}
      <div class="row bg-cstm-green-lightest rounded my-3 px-2 py-4">
        <div class="col">
          <h1 id="description-header"><strong>Description</strong></h1>
          <h4 class="my-2" id="description">{{recipe.description}}</h4>
        </div>
      </div>
    {{/if}}
    <div class="row bg-cstm-green-lightest rounded my-3 px-2 py-4">
      <div class="col">
        <h1 id="ingredients-header"><strong>Ingredients</strong></h1>
        <div id="ingredients">
          {{#each recipe.ingredients}}
            {{this}}<br>
          {{/each}}
        </div>
      </div>
    </div>
    <div class="row bg-cstm-green-lightest rounded my-3">
      <div class="col">
        <h1 id="steps-header" class="mx-2"><strong>Steps</strong></h1>
        <ol id="steps">
          {{#each recipe.steps}}
            <li>{{this}}</li>
          {{/each}}
        </ol>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <h1 id="comments-header">Comments:</h1>
        <div id="comments">
          {{#if comments}}
            {{#each comments}}
            <div class="row bg-cstm-orange-lighter my-2 px-2 pt-2 pb-4">
              <div class="col-2">
                <a href="/profile/{{author.username}}">{{author.display_name}}</a>
                <a href="/profile/{{author.username}}">
                  <img id="profile-img-1" src="{{author.picture_link}}" class="rounded img-fluid">
                </a>
              </div>
              <div class="col-10">
                <span class="float-right">{{timestamp}}</span>
                <div class="mb-3 mt-4" style="min-height: 100px;">
                  {{text}}
                </div>
                {{!-- {{#if registered}}
                <button type="button" class="btn float-right border-0 bg-cstm-orange"><span style="font-size: 12px;" class="fa fa-minus"></span> Report Comment</button>
                {{/if}}--}}
                {{#if owned}}
                <form action="/recipe/{{../recipeId}}/comment/edit" method="POST">
                  <div class="form-group">
                    <input type="text" class="d-none form-control" name="id" value="{{_id}}">
                    <textarea class="form-control" name="text"></textarea>
                    <button class="float-left btn btn-cstm-orange-darker mt-3" type="submit">Edit</button>
                  </div>
                </form>
                <form action="/recipe/{{../recipeId}}/comment/delete" method="POST">
                  <div class="form-group">
                    <input type="text" class="d-none form-control" name="id" value="{{_id}}">
                    <button class="float-left ml-2 btn btn-cstm-orange-darker" type="submit">Delete</button>
                  </div>
                </form>
                {{/if}}
              </div>
            </div>
            {{/each}}
          {{else}}
            <div class="text-center">
              <h4>No comments yet!</h4>
            </div>
          {{/if}}
          {{#if registered}}
          <form action="/recipe/{{recipeId}}/comment" method="POST">
            <div class="form-group p-3">
              <textarea id="comment-box" class="form-control" name="text"></textarea>
              <button class="btn btn-cstm-orange my-2" type="submit"><span class="fa fa-comment fa-fw"></span> Comment</button>
            </div>
          </form>
          {{else}}
          <div class="text-center">
            <h4>Register to add a comment of your own!</h4>
          </div>
          {{/if}}
        </div>
      </div>
    </div>
</main>
